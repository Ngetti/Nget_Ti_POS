<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Product Management</title>
    <link rel="stylesheet" href="bootstrap.css" />
    <style>
      body {
        background: #f8f9fa;
      }
      .formProduct {
        border-radius: 12px;
        border: 1px solid #dee2e6;
        box-shadow: 0 4px 15px rgba(0, 0, 0, 0.08);
        padding: 20px;
        background: #fff;
      }
      .formProduct label {
        font-weight: 600;
        margin-top: 10px;
      }
      #btn_save {
        float: right;
        background: #007bff;
        border-radius: 6px;
        border: none;
        color: white;
        padding: 10px 20px;
        font-weight: bold;
        transition: 0.3s;
      }
      #btn_save:hover {
        background: #0056b3;
      }
      #btn_cancel {
        float: left;
        background: #dc3545;
        border-radius: 6px;
        border: none;
        color: white;
        padding: 10px 20px;
        font-weight: bold;
        transition: 0.3s;
      }
      #btn_cancel:hover {
        background: #a71d2a;
      }
      /* Table */
      .table thead {
        background: linear-gradient(90deg, #007bff, #0056b3);
        color: #fff;
      }
      .table td,
      .table th {
        vertical-align: middle;
        text-align: center;
      }
      img {
        width: 50px;
        height: 50px;
        object-fit: cover;
        border-radius: 6px;
      }
      .btn-edit {
        background: #ffc107;
        border: none;
        padding: 6px 15px;
        border-radius: 5px;
        color: white;
        font-weight: 500;
        transition: 0.3s;
      }
      .btn-edit:hover {
        background: #e0a800;
      }
      .btn-remove {
        background: #dc3545;
        border: none;
        padding: 6px 15px;
        border-radius: 5px;
        color: white;
        font-weight: 500;
        transition: 0.3s;
      }
      .btn-remove:hover {
        background: #a71d2a;
      }
    </style>
  </head>

  <body>
    <div class="container-fluid py-4">
      <div class="row g-4">
        <div class="col-lg-4">
          <div class="form_box">
            <form action="#" method="get" class="formProduct">
              <h4 class="text-center text-primary mb-3">Add Product</h4>
              <div class="form-group">
                <label for="name">Name</label>
                <input type="text" id="name" class="form-control" />
              </div>
              <div class="form-group">
                <label for="category">Category</label>
                <select id="category" class="form-control">
                  <option value="Drink">Drink</option>
                  <option value="Food">Food</option>
                  <option value="Water">Water</option>
                </select>
              </div>
              <div class="form-group">
                <label for="qty">Qty</label>
                <input type="number" id="qty" class="form-control" />
              </div>
              <div class="form-group">
                <label for="price">Price</label>
                <input type="number" id="price" class="form-control" />
              </div>
              <div class="form-group">
                <label for="image_url">Image URL</label>
                <input type="url" id="image_url" class="form-control" />
              </div>
              <div class="form-group mt-3 clearfix">
                <input type="button" id="btn_cancel" value="Cancel" />
                <input type="button" id="btn_save" value="Save" />
              </div>
            </form>
          </div>
        </div>

        <div class="col-lg-8">
          <div class="table-responsive">
            <table class="table table-striped table-bordered align-middle" id="product_list">
              <thead>
                <tr>
                  <th>#</th>
                  <th>Name</th>
                  <th>Category</th>
                  <th>Qty</th>
                  <th>Price</th>
                  <th>Photo</th>
                  <th colspan="2">Action</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td>1</td>
                  <td>Coca Cola</td>
                  <td>Drink</td>
                  <td>20</td>
                  <td>$1.50</td>
                  <td><img src="https://via.placeholder.com/50" alt="Coca Cola" /></td>
                  <td><button class="btn-edit">‚úè Edit</button></td>
                  <td><button class="btn-remove">üóë Remove</button></td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>
      </div>
    </div>
  </body>
  <script src="main.js"></script>
  <script>
    let name = document.getElementById("name");
    let category = document.getElementById("category");
    let qty = document.getElementById("qty");
    let price = document.getElementById("price");
    let image_url = document.getElementById("image_url");
    let btn_save = document.getElementById("btn_save");
    let btn_cancel = document.getElementById("btn_cancel");
    let product_list = document.querySelector("#product_list tbody");
    let produts = getStudentList();
    let edit = null;
    renderList();
    btn_save.addEventListener("click", function () {
      if (name.value.trim() == "") {
        name.focus();
        return;
      }
      if (price.value.trim() == "" || price.value < 1) {
        price.focus();
        return;
      }
      if (image_url.value.trim() == "") {
        image_url.focus();
        return;
      }

      let value_name = name.value;
      let value_category = category.value;
      let value_qty = qty.value;
      let value_price = price.value;
      let value_imageURL = image_url.value;

      if (edit != null) {
        produts[edit] = {
          value_name,
          value_category,
          value_qty,
          value_price,
          value_imageURL,
        };
        localStorage.setItem("product_list", JSON.stringify(produts));
        btn_save.value = "Save";
        edit = null;
        Swal.fire({
          title: "Product Edited",
          icon: "success",
          draggable: true,
        });
      } else {
        produts.push({
          value_name,
          value_category,
          value_qty,
          value_price,
          value_imageURL,
        });
        localStorage.setItem("product_list", JSON.stringify(produts));
        Swal.fire({
          title: "Product add successfully",
          icon: "success",
          draggable: true,
        });
      }

      renderList();
      name.value = "";
      price.value = "";
      image_url.value = "";

      name.focus();
    });
    function renderList() {
      product_list.innerHTML = "";
      let obj_product = getStudentList();
      obj_product.forEach(function (item, index) {
        let new_tag = document.createElement("tr");
        new_tag.innerHTML = `
        <td> ${index + 1}</td>
        <td> ${item.value_name}</td>
        <td> ${item.value_category}</td>
        <td> ${item.value_qty}</td>
        <td> ${item.value_price} $</td>
        <td><img src="${item.value_imageURL}" alt=""> </td>
        <td> <button id="editItem" onclick="editItem(${index})">Edit</button></td>        
        <td> <button id="removeItem" onclick="removeItem(${index})">Remove</button></td>
        `;
        product_list.appendChild(new_tag);
      });
    }
    function getStudentList() {
      let st_product = localStorage.getItem("product_list") ?? "[]";
      return JSON.parse(st_product);
    }
    function removeItem(index) {
      if (edit == null) {
        Swal.fire({
          title: "Are you sure?",
          text: "You won't be able to revert this!",
          icon: "warning",
          showCancelButton: true,
          confirmButtonColor: "#3085d6",
          cancelButtonColor: "#d33",
          confirmButtonText: "Yes, delete it!",
        }).then((result) => {
          if (result.isConfirmed) {
            Swal.fire({
              title: "Deleted!",
              text: `Your Product ID: ${index + 1} has been deleted.`,
              icon: "success",
            });
            produts.splice(index, 1);
            localStorage.setItem("product_list", JSON.stringify(produts));
            renderList();
            name.focus();
          }
        });
      } else {
        Swal.fire({
          icon: "error",
          title: "Product editting",
          text: "You Can not delete this Product!",
          footer: "Check try again !",
        });
      }
    }
    function editItem(index) {
      name.value = produts[index].value_name;
      category.value = produts[index].value_category;
      qty.value = produts[index].value_qty;
      price.value = produts[index].value_price;
      image_url.value = produts[index].value_imageURL;
      btn_save.value = "Edit";
      edit = index;
    }
    function cancel() {
      name.value = "";
      qty.value = "";
      price.value = "";
      image_url.value = "";
      name.focus();
    }
  </script>
</html>
